<% layout('layouts/dashboard') %>
<% title = 'New Initiative' %>

<h2 class="mb-4">ğŸš€ Create New Initiative</h2>

<form action="/<%= orgName %>/initiatives" method="POST" class="card p-4 shadow-sm">
  <div class="mb-3">
    <label for="keyResultId" class="form-label">ğŸ¯ Key Result</label>
    <select name="keyResultId" id="keyResultId" class="form-select">
      <option value="">-- Select Key Result --</option>
      <% keyResults.forEach(kr => { %>
        <option value="<%= kr._id %>" <%= (kr._id.toString() === preselectedKeyResultId) ? 'selected' : '' %>>
          <%= kr.title %>
        </option>
      <% }) %>
    </select>
    <small class="text-muted">Link this initiative to a Key Result (optional but recommended).</small>
  </div>

  <div class="mb-3">
    <label for="title" class="form-label">ğŸ“Œ Title <span class="text-danger">*</span></label>
    <input type="text" name="title" id="title" class="form-control" required>
  </div>

  <div class="mb-3">
    <label for="description" class="form-label">ğŸ“ Description</label>
    <textarea name="description" id="description" class="form-control" rows="3" placeholder="Brief context or plan..."></textarea>
  </div>

  <div class="mb-3">
    <label for="expectedOutcome" class="form-label">ğŸ¯ Expected Outcome <span class="text-danger">*</span></label>
    <textarea name="expectedOutcome" id="expectedOutcome" class="form-control" rows="2" required></textarea>
    <small class="text-muted">Be clear about what success looks like.</small>
  </div>

  <div class="d-flex justify-content-between mt-4">
    <a href="/<%= orgName %>/objectives" class="btn btn-outline-secondary">â¬… Cancel</a>
    <button type="submit" class="btn btn-success">âœ… Create Initiative</button>
  </div>
</form>
