<% layout('layouts/dashboard') %>
<% title = 'Initiatives under ' + keyResult.title %>

<h2 class="mb-4">📌 Initiatives for KR: <span class="text-primary"><%= keyResult.title %></span></h2>

<a href="/<%= orgName %>/objectives/<%= keyResult.objectiveId %>/keyresults" class="btn btn-outline-secondary mb-4">⬅ Back to Key Results</a>

<% if (initiatives.length === 0) { %>
  <div class="alert alert-info">No initiatives linked to this Key Result.</div>
<% } else { %>
  <ul class="list-group">
    <% initiatives.forEach(ini => { %>
      <li class="list-group-item d-flex justify-content-between align-items-start flex-column flex-md-row">
        <div class="mb-2 mb-md-0 me-md-3 flex-grow-1">
          <h5 class="mb-1"><%= ini.title %></h5>
          <p class="text-muted mb-1 small"><%= ini.expectedOutcome || '—' %></p>
          <span class="badge 
            <%= ini.status === 'Initiated' ? 'bg-primary' : 
                  ini.status === 'Closed' ? 'bg-success' :
                  ini.status === 'Blocked' ? 'bg-danger' :
                  ini.status === 'Deferred/On Hold' ? 'bg-warning text-dark' :
                  ini.status === 'Dropped' ? 'bg-secondary' : 'bg-light text-dark' %>">
            <%= ini.status %>
          </span>
        </div>
        <a href="/<%= orgName %>/initiatives/<%= ini._id %>" class="btn btn-sm btn-outline-primary">🔍 View</a>
      </li>
    <% }) %>
  </ul>
<% } %>