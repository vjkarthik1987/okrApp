<% layout('layouts/dashboard') %>
<% title = 'Change Password' %>

<h2>üîí Change Password</h2>

<form method="POST" action="/<%= orgName %>/auth/change-password" class="mt-3" onsubmit="return checkPasswordsMatch()">
  <div class="mb-3">
    <label>Current Password</label>
    <input type="password" name="currentPassword" class="form-control" required>
  </div>

  <div class="mb-3">
    <label>New Password</label>
    <input type="password" id="newPassword" name="newPassword" class="form-control" required>
  </div>

  <div class="mb-3">
    <label>Confirm New Password</label>
    <input type="password" id="confirmPassword" name="confirmPassword" class="form-control" required>
    <small id="matchMsg" class="form-text"></small>
  </div>

  <button class="btn btn-primary">Change Password</button>
</form>

<script>
  function checkPasswordsMatch() {
    const pw = document.getElementById('newPassword').value;
    const cpw = document.getElementById('confirmPassword').value;
    if (pw !== cpw) {
      document.getElementById('matchMsg').innerText = "‚ùå Passwords do not match!";
      return false;
    }
    return true;
  }

  document.getElementById('confirmPassword').addEventListener('input', () => {
    const pw = document.getElementById('newPassword').value;
    const cpw = document.getElementById('confirmPassword').value;
    const msg = document.getElementById('matchMsg');
    msg.innerText = pw === cpw ? "‚úÖ Passwords match" : "‚ùå Passwords do not match";
  });
</script>
